From 6e6793182b0d1fbd72bd69b369a28dc056a1c23e Mon Sep 17 00:00:00 2001
From: Honglin Leng <dev@radxa.com>
Date: Thu, 28 Aug 2025 03:42:56 +0000
Subject: [PATCH 1/2] drivers: bcmdhd: Modify Makefile to use CURDIR instead of
 PWD to ensure the build path is correct

Signed-off-by: Honglin Leng <dev@radxa.com>
---
 src/drivers/bcmdhd/Makefile | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/drivers/bcmdhd/Makefile b/src/drivers/bcmdhd/Makefile
index c673785..061c22f 100644
--- a/src/drivers/bcmdhd/Makefile
+++ b/src/drivers/bcmdhd/Makefile
@@ -490,15 +490,15 @@ all: bcmdhd_pcie bcmdhd_sdio bcmdhd_usb
 
 bcmdhd_pcie:
 	$(warning "building BCMDHD_PCIE..........")
-	$(MAKE) -C $(LINUXDIR) M=$(PWD) ARCH=$(ARCH) CROSS_COMPILE=$(CROSS_COMPILE) modules CONFIG_BCMDHD=m CONFIG_BCMDHD_PCIE=y
+	$(MAKE) -C $(LINUXDIR) M=$(CURDIR) ARCH=$(ARCH) CROSS_COMPILE=$(CROSS_COMPILE) modules CONFIG_BCMDHD=m CONFIG_BCMDHD_PCIE=y
 
 bcmdhd_sdio:
 	$(warning "building BCMDHD_SDIO..........")
-	$(MAKE) -C $(LINUXDIR) M=$(PWD) ARCH=$(ARCH) CROSS_COMPILE=$(CROSS_COMPILE) modules CONFIG_BCMDHD=m CONFIG_BCMDHD_SDIO=y
+	$(MAKE) -C $(LINUXDIR) M=$(CURDIR) ARCH=$(ARCH) CROSS_COMPILE=$(CROSS_COMPILE) modules CONFIG_BCMDHD=m CONFIG_BCMDHD_SDIO=y
 
 bcmdhd_usb:
 	$(warning "building BCMDHD_USB..........")
-	$(MAKE) -C $(LINUXDIR) M=$(PWD) ARCH=$(ARCH) CROSS_COMPILE=$(CROSS_COMPILE) modules CONFIG_BCMDHD=m CONFIG_BCMDHD_USB=y
+	$(MAKE) -C $(LINUXDIR) M=$(CURDIR) ARCH=$(ARCH) CROSS_COMPILE=$(CROSS_COMPILE) modules CONFIG_BCMDHD=m CONFIG_BCMDHD_USB=y
 
 clean:
 	rm -rf *.o *.ko *.mod.c *~ .*.cmd *.o.cmd .*.o.cmd *.mod \
-- 
2.49.0

